# 실시간 이성 소개 기능 구현 명령어

## 핵심 요구사항
- UI 절대 변경 금지
- 더미 데이터, 로컬 데이터 생성 금지  
- AWS 데이터베이스에서 실제 데이터만 사용
- 성별 기반 이성 매칭 (남성→여성, 여성→남성)

## Claude Code 명령어

### 1. 현재 사용자 성별 확인 및 이성 필터링 로직 구현
```
현재 로그인된 사용자의 성별을 AWS 데이터베이스에서 조회하고, 
반대 성별의 사용자만 필터링하여 가져오는 기능을 구현해주세요.

요구사항:
- AWS Cognito에서 현재 사용자 ID 확인
- DynamoDB/RDS에서 사용자 프로필의 성별 정보 조회
- 현재 사용자가 남성이면 여성 프로필만, 여성이면 남성 프로필만 조회
- 이미 평가한(좋아요/싫어요) 사용자는 제외
- UI는 절대 변경하지 말고 기존 UI 컴포넌트에 데이터만 연결
```

### 2. 실시간 프로필 스트리밍 시스템 구현
```
AWS에서 실시간으로 이성 프로필을 가져와서 기존 UI에 표시하는 기능을 구현해주세요.

기술 요구사항:
- AWS AppSync 또는 DynamoDB Streams를 사용한 실시간 데이터 동기화
- 새로운 사용자 가입 시 즉시 매칭 풀에 추가
- 사용자 프로필 업데이트 시 실시간 반영
- 오프라인 사용자 자동 제외
- 거리 기반 필터링 (선택사항)

데이터 흐름:
1. AWS에서 이성 프로필 실시간 조회
2. 기존 UI 컴포넌트에 데이터 바인딩
3. 스와이프/버튼 액션 시 다음 프로필 자동 로드
```

### 3. 지능형 매칭 알고리즘 구현
```
단순한 성별 필터링을 넘어서 더 정교한 매칭 로직을 구현해주세요.

매칭 기준:
- 성별 (필수): 이성만 매칭
- 연령대: 사용자 설정 범위 내
- 지역: 일정 거리 내 (GPS 기반)
- 온라인 상태: 최근 활동 사용자 우선
- 호감도: 상호 호감 가능성이 높은 사용자 우선

AWS 구현:
- DynamoDB GSI(Global Secondary Index)를 활용한 효율적인 쿼리
- 매칭 점수 계산 로직
- 실시간 위치 업데이트 처리
```

### 4. 매칭 풀 관리 시스템 구현
```
효율적인 매칭 풀 관리를 위한 시스템을 구현해주세요.

기능:
- 사용자별 매칭 풀 생성 및 관리
- 이미 평가한 사용자 자동 제외
- 매칭 풀 소진 시 자동 갱신
- 프리미엄 사용자 우선 노출
- 지역별 매칭 풀 분리

AWS 구성:
- DynamoDB 파티션 키 설계
- 매칭 이력 테이블 구성
- 자동 정리 시스템 (TTL 활용)
```

### 5. 실시간 알림 및 상태 업데이트
```
실시간 매칭 상태를 사용자에게 알려주는 시스템을 구현해주세요.

알림 기능:
- 새로운 매칭 대상 등장 알림
- 호감 받았을 때 실시간 알림
- 매칭 성사 시 즉시 알림
- 슈퍼챗 수신 알림

AWS 구현:
- AWS SNS/SES를 통한 푸시 알림
- WebSocket 연결로 실시간 상태 업데이트
- 사용자별 알림 설정 관리
```

## 구체적인 구현 단계

### Step 1: 데이터베이스 쿼리 최적화
```
# 이성 프로필 조회 최적화
AWS DynamoDB에서 다음 조건으로 프로필을 효율적으로 조회하는 쿼리를 구현해주세요:

쿼리 조건:
- 현재 사용자와 반대 성별
- 현재 사용자가 아직 평가하지 않은 사용자
- 활성 상태 (최근 7일 내 로그인)
- 지역 필터 (50km 반경 내)
- 연령 필터 (사용자 설정 범위)

성능 요구사항:
- 쿼리 응답 시간 1초 이내
- 페이지네이션 지원 (20명씩)
- 캐싱 활용으로 중복 요청 방지
```

### Step 2: 실시간 데이터 동기화
```
# 실시간 프로필 업데이트 시스템
AWS AppSync GraphQL을 사용하여 실시간 데이터 동기화를 구현해주세요:

구독(Subscription) 설정:
- 새로운 사용자 프로필 생성 시
- 기존 사용자 프로필 업데이트 시
- 사용자 온라인/오프라인 상태 변경 시
- 위치 정보 업데이트 시

플러터 클라이언트:
- GraphQL 구독 연결 관리
- 백그라운드에서 실시간 데이터 수신
- UI 자동 업데이트 (기존 UI 구조 유지)
```

### Step 3: 지능형 추천 알고리즘
```
# AI 기반 매칭 추천 시스템
사용자의 선호도를 학습하여 더 정확한 매칭을 제공하는 시스템을 구현해주세요:

학습 데이터:
- 사용자의 좋아요/싫어요 패턴
- 메시지 교환 빈도
- 프로필 체류 시간
- 매칭 성공률

AWS ML 서비스:
- Amazon Personalize를 활용한 추천 엔진
- 실시간 추천 결과 반영
- A/B 테스트를 통한 알고리즘 개선
```

### Step 4: 성능 모니터링 및 최적화
```
# 실시간 매칭 성능 모니터링
매칭 시스템의 성능을 모니터링하고 최적화하는 시스템을 구현해주세요:

모니터링 지표:
- 매칭 풀 크기
- 쿼리 응답 시간
- 사용자 만족도 (좋아요 비율)
- 시스템 부하

AWS 모니터링:
- CloudWatch 대시보드 구성
- 알람 설정 (성능 저하 시)
- 로그 분석 및 최적화 제안
```

## 최종 Claude Code 명령어

```
Flutter 데이팅앱에 실시간 이성 소개 기능을 구현해주세요.

핵심 요구사항:
1. UI는 절대 변경하지 말고 기존 UI 컴포넌트에만 데이터 연결
2. 더미 데이터나 로컬 데이터는 생성하지 말고 AWS 데이터베이스만 사용
3. 현재 로그인 사용자의 성별을 확인하여 반대 성별만 매칭

구현 순서:
1. 현재 사용자 프로필에서 성별 정보 조회
2. AWS DynamoDB에서 이성 프로필만 필터링하여 조회
3. 이미 평가한 사용자 제외 로직 구현
4. 실시간 데이터 동기화 (AppSync 또는 DynamoDB Streams)
5. 기존 UI에 실시간 데이터 바인딩
6. 스와이프/액션 시 다음 프로필 자동 로드
7. 매칭 풀 소진 시 자동 갱신 시스템

기술 스택:
- 백엔드: AWS DynamoDB, AppSync, Cognito
- 실시간: WebSocket 또는 GraphQL Subscription
- 인증: 기존 AWS Cognito 설정 활용
- 위치: GPS 기반 거리 필터링

성능 목표:
- 프로필 로딩: 1초 이내
- 실시간 업데이트: 3초 이내
- 매칭 풀 갱신: 자동, 백그라운드 처리
```