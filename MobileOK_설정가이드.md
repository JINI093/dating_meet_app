# MobileOK 본인인증 설정 가이드

## 📋 현재 상황
- ✅ 키 파일: `mok_keyInfo.dat 2` 파일이 프로젝트 루트에 존재
- ✅ MobileOK 서비스 코드 구현 완료
- ⚠️ **키 파일 패스워드 필요**
- ⚠️ **웹관리도구 회원사ID 필요**

## 🔧 조치해야 할 사항

### 1. 드림시큐리티에서 제공한 정보 확인
다음 정보를 확인하고 `.env` 파일에 설정해야 합니다:

```env
# 현재 설정 (수정 필요)
MOBILEOK_KEY_PASSWORD=키파일패스워드_확인필요  # ← 실제 패스워드로 교체
MOBILEOK_CLIENT_PREFIX=웹관리도구회원사ID_확인필요  # ← 실제 회원사ID로 교체
```

### 2. 필요한 정보 목록

#### A. 키 파일 패스워드
- **설명**: `mok_keyInfo.dat 2` 파일을 복호화하기 위한 패스워드
- **제공처**: 드림시큐리티 담당자
- **형태**: 문자열 (예: "mypassword123")

#### B. 웹관리도구 회원사ID
- **설명**: 드림시큐리티에서 발급한 고유 회원사 식별자
- **제공처**: 드림시큐리티 웹관리도구 또는 담당자
- **형태**: 문자열 (예: "COMPANY001", "TEST_CLIENT")
- **용도**: 거래 ID 생성 시 prefix로 사용

#### C. 서비스 ID (선택사항)
- **설명**: MobileOK 서비스 고유 식별자
- **현재**: 키 파일에서 자동 추출 시도
- **대안**: 별도 환경변수로 설정 가능

### 3. 설정 방법

#### 단계 1: 드림시큐리티 담당자에게 문의
다음 정보를 요청하세요:
```
1. mok_keyInfo.dat 2 파일의 패스워드
2. 웹관리도구에서 확인 가능한 회원사ID
3. 개발환경 테스트 계정 정보 (있는 경우)
```

#### 단계 2: .env 파일 업데이트
정보를 받은 후 다음과 같이 수정:
```env
# MobileOK 키 정보 (실제 값으로 교체)
MOBILEOK_KEY_PASSWORD=실제패스워드
MOBILEOK_CLIENT_PREFIX=실제회원사ID
```

#### 단계 3: 앱 재시작 및 테스트
```bash
flutter hot restart
```

### 4. 현재 코드 동작 방식

#### 시뮬레이션 조건 (현재 상태)
```dart
// 다음 조건일 때 시뮬레이션 모드 실행:
final forceSimulation = additionalParams?['enableSimulation'] == true;
final missingKeys = _keyPassword.contains('확인필요') || _clientPrefix.contains('확인필요');

if (forceSimulation || missingKeys) {
  // 시뮬레이션 모드 실행
}
```

#### 실제 연동 활성화 조건
- `MOBILEOK_KEY_PASSWORD`에 실제 패스워드 설정
- `MOBILEOK_CLIENT_PREFIX`에 실제 회원사ID 설정
- `enableSimulation: false` 또는 제거

### 5. 테스트 방법

#### 현재 (시뮬레이션 모드)
1. 앱에서 "회원가입" 클릭
2. "시뮬레이션 (개발용)" 버튼으로 테스트
3. 가상의 인증 결과 확인

#### 실제 연동 후
1. 앱에서 "회원가입" 클릭  
2. "MobileOK 본인인증 시작" 클릭
3. 웹뷰에서 실제 MobileOK 인증 진행
4. 휴대폰 본인인증 완료

### 6. 문제 해결

#### 키 파일 관련 오류
```
⚠️ MobileOK 키 파일 없음: [경로]
```
→ 키 파일 경로 확인 및 파일 존재 여부 체크

#### 패스워드 관련 오류
```
❌ 키 파일 복호화 실패
```
→ 패스워드 정확성 확인

#### API 연결 오류
```
❌ MobileOK API 연결 실패
```
→ 네트워크 상태 및 서버 URL 확인

### 7. 드림시큐리티 연락처

MobileOK 기술지원팀에 다음 사항을 문의하세요:
- 키 파일 패스워드
- 웹관리도구 회원사ID  
- 개발환경 테스트 가이드
- API 연동 문서

## 🎯 요약

**현재 상태**: 코드 구현 완료, 설정 정보만 필요
**필요 작업**: 2개 환경변수 값만 업데이트하면 즉시 사용 가능
**예상 소요시간**: 정보 확인 후 5분 내 완료